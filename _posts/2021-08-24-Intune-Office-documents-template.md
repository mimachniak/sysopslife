---
title: "Intune (Endpoint Manager) - How to deploy Office templates and keep them up to date."
classes: wide
excerpt: "Intune (Endpoint Manager) - How to deploy Office templates and keep them up to date. Office template used in organization are mote common and easy task to be deployed over GPO, most of organization have own templates with logos, formats etc. Templates are often store on some file share from where computer / user can download them, so storage is some of barriers when we like to use full cloud MDM in form of SaaS."
toc: true
header:
  image: /assets/images/Intune/Intune-1.png
  teaser: /assets/images/Intune/Intune-1.png
categories:
  - SysOps
  - Office
  - PowerShell
tags:
  - Intune
  - MDM
  - Office
  - Automation
  - Azure
published: false
---

## Why I write this article

Deploy office template used in organization are common and easy task to be deployed over GPO, most of organization have own templates with logos, formats etc. Templates are often store on some file share from where computer / user can download them, so storage is some of barriers when we like to use full cloud MDM in form of SaaS.  
Another limitation is that Intune don't have ability to tun PowerShell script in some schedule. 
On this article I will show how to do it with full cloud based solution, for this I will use Azure and Intune.

## Prerequisites 

On this articel we will use: 
* Azure storage account
* Intune (Endpoint Manager)
* PowerShell scripts

## Azure subscription 

First we will need to create free Azure Subscription:

Guide: [![Is Azure Free Account really free? | Azure Tips and Tricks](/assets/images/Azure/azure-free-account.PNG)](https://www.youtube.com/watch?v=0KEfaUfolVs&ab_channel=MicrosoftAzure)

Link : [Create Free Azure account](https://azure.microsoft.com/en-us/free/)

## Azure storage account

To storge office templete and script responsible for deploying templates in local machine, we will use azure storage account with **public blob container**. Storage account is one of chepes solution to keep data and expensive are based on amount of data counted in GB per month.

### Create stroage account in Azure

1. Logon to https://portal.azure.com 
2. On top search bar type **storage account**
3. On navigation bar click **Create**
4. Enter data in **Basic** tab
5. On **Advanced** tab click **Next**
6. On **Networking** tab click **Next**
7. On **Data protection** tab click **Next**
8. On **Tags** tab click **Next**
8. On **Review + Create** tab click **Create** if Validation passed

### Create public blob on storage account

1. Logon to https://portal.azure.com 
2. On top search bar type **storage account**
3. Click on storage account created previously
4. On left navigation maenu click on **Containers**
5. On navigation bar click **Container**
6. Enter date for new container and chage public access level then click **Create**
7. Click on created container with name **office-template**
8. Upload office template files by clicking **Upload** on navigation menu
9. Click on created container with name **scripts**

## PowerShell scripts data preparation

Powershell scripts can be found on my repository under this link: https://github.com/mimachniak/sysopslife-scripts/Intune

### Prepare script that will download Office template file to dedicated folder

#### Script responsible for downloading templates to local environment
1. Change parameter date dedicated for your environment

```powershell

$LogLocation = 'C:\Users\Public\Documents\' # Location of lgs generated by execution of the script
$LogFileName = 'OfficeTemplates.log' # log file name


Start-Transcript -Path  $LogLocation$LogFileName# Create log each run script

$storageAccountName = "dofficetemplate.blob.core.windows.net" # Azure Storage Acccount Url
$containerName = "office-template" # Azure storage account blob container with files
$TemplateFolderName = 'Office Templates' # Folder name on desktop when files willbe downloaded

```

2. Storage account **Name** is available in **Endpoints** section in Azure on **Blob**
3. Upload script to **Container** on storage account, the same **container** name **scripts**
4. Click on uploade script with name **Intune-DocumentTemplateStorageAccount.ps1**
5. Copy **URL** and past it to second script that will be deploy by **Intune**

#### Script responsible creating by Intune task schduler that will execute script each time user log in to desktop.

1. Change parameter date dedicated for your environment

```powershell

$LogLocation = 'C:\Users\Public\Documents\' # Location of lgs generated by execution of the script
$LogFileName = 'IntunePowerShell.log' # log file name

$storageAccountNameScriptUrl = 'https://dofficetemplate.blob.core.windows.net/scripts/Intune-DocumentTemplateStorageAccount.ps1' # Azure Storage Acccount Url to script

```