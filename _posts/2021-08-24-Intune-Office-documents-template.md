---
title: "Intune (Endpoint Manager) - How to deploy Office templates and keep them up to date."
classes: wide
excerpt: "Intune (Endpoint Manager) - How to deploy Office templates and keep them up to date. Office template used in organization are mote common and easy task to be deployed over GPO, most of organization have own templates with logos, formats etc. Templates are often store on some file share from where computer / user can download them, so storage is some of barriers when we like to use full cloud MDM in form of SaaS."
toc: true
header:
  image: /assets/images/Intune/Intune-1.png
  teaser: /assets/images/Intune/Intune-1.png
categories:
  - SysOps
  - Office
  - PowerShell
tags:
  - Intune
  - MDM
  - Office
  - Automation
  - Azure
published: true
hidden: true
---

## Why I write this article

Deploy office template used in organization are common and easy task to be deployed over GPO, most of organization have own templates with logos, formats etc. Templates are often store on some file share from where computer / user can download them, so storage is some of barriers when we like to use full cloud MDM in form of SaaS.  
Another limitation is that Intune don't have ability to tun PowerShell script in some schedule. 
On this article I will show how to do it with full cloud based solution, for this I will use Azure and Intune.

## Prerequisites 

On this articel we will use: 
* Azure storage account
* Intune (Endpoint Manager)
* PowerShell scripts

## Azure subscription 

First we will need to create free Azure Subscription:

Guide: [![Is Azure Free Account really free? | Azure Tips and Tricks](/assets/images/Azure/azure-free-account.PNG)](https://www.youtube.com/watch?v=0KEfaUfolVs&ab_channel=MicrosoftAzure)

Link : [Create Free Azure account](https://azure.microsoft.com/en-us/free/)

## Azure storage account

To storge office templete and script responsible for deploying templates in local machine, we will use azure storage account with **public blob container**. Storage account is one of chepes solution to keep data and expensive are based on amount of data counted in GB per month.

### Create stroage account in Azure

1. Logon to https://portal.azure.com 
2. On top search bar type **storage account**
3. On navigation bar click **Create**
4. Enter data in **Basic** tab
5. On **Advanced** tab click **Next**
6. On **Networking** tab click **Next**
7. On **Data protection** tab click **Next**
8. On **Tags** tab click **Next**
8. On **Review + Create** tab click **Create** if Validation passed

### Create public blob on storage account

1. Logon to https://portal.azure.com 
2. On top search bar type **storage account**
3. Click on storage account created previously
4. On left navigation maenu click on **Containers**
5. On navigation bar click **Container**
6. Enter date for new container and chage public access level then click **Create**
7. Click on created container with name **office-template**
8. Upload office template files by clicking **Upload** on navigation menu
9. Click on created container with name **scripts**

## PowerShell scripts data preparation

Powershell scripts can be found on my repository under this link: https://github.com/mimachniak/sysopslife-scripts/Intune

### Prepare script that will download Office template file to dedicated folder

#### Script responsible for downloading templates to local environment
1. Change parameter date dedicated for your environment, script can be downloaded form GitHub: [Intune-DocumentTemplateStorageAccount.ps1](https://github.com/mimachniak/sysopslife-scripts/blob/master/Intune/Intune-DocumentTemplateStorageAccount.ps1)

```powershell

$LogLocation = 'C:\Users\Public\Documents\' # Location of lgs generated by execution of the script
$LogFileName = 'OfficeTemplates.log' # log file name


Start-Transcript -Path  $LogLocation$LogFileName# Create log each run script

$storageAccountName = "dofficetemplate.blob.core.windows.net" # Azure Storage Acccount Url
$containerName = "office-template" # Azure storage account blob container with files
$TemplateFolderName = 'Office Templates' # Folder name on desktop when files willbe downloaded

```

2. Storage account **Name** is available in **Endpoints** section in Azure on **Blob**
3. Upload script to **Container** on storage account, the same **container** name **scripts**
4. Click on uploade script with name **Intune-DocumentTemplateStorageAccount.ps1**
5. Copy **URL** and past it to second script that will be deploy by **Intune**

#### Script responsible creating by Intune task schduler that will execute script each time user log in to desktop.

1. Change parameter date dedicated for your environment, script can be downloaded form GitHub: [Windows10-taskScheduler-register-executescript-url.ps1](https://github.com/mimachniak/sysopslife-scripts/blob/master/Intune/Windows10-taskScheduler-register-executescript-url.ps1)

```powershell

$LogLocation = 'C:\Users\Public\Documents\' # Location of lgs generated by execution of the script
$LogFileName = 'IntunePowerShell.log' # log file name

$storageAccountNameScriptUrl = 'https://dofficetemplate.blob.core.windows.net/scripts/Intune-DocumentTemplateStorageAccount.ps1' # Azure Storage Acccount Url to script

```
2. Logon to https://endpoint.microsoft.com
3. In Endpoint Manager Consol navigate to **Devices --> Windows --> PowerShell scripts**
4. On navigation click **Add**
5. Enter **Name** and **Description**
6. On **Script Settings** add script and select **Run this script using the logged on credentials**

>
> The script runs with the usersâ€™ credentials on the client computer. By default, the script runs in system context.
>

7. On **Assignments** and ***All Users** or selected group of **Users**
8. Click **Next** and **Add**

## Windows 10 veryfication

### Intune policy synchronization force

1. Log on to device 
2. Navigate to **Settings --> Accounts --> Access work or school**
3. Click on connection and then on **Info**
4. Scroll down and click on **Sync**
5. After sync completed (can take to 30 min) go to **task scheduler**
6. Veryfie that task was create on Windows 10
7. Run taks in ***task scheduler** and verify that templates was downloaded to local folder

